

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="Topic: Fourier Series, Category: Section" name="description" />
<meta content="frequency decomposition, Fourier spectrum, signal processing, fft, dft" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Decomposing Audio Signals: Fourier Analysis &mdash; CogWorks</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Discrete Fourier Transform (DFT)" href="discrete_fourier_transforms.html" />
    <link rel="prev" title="Exercises: Analog to Digital Encoding" href="Exercises/AnalogToDigital.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CogWorks
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">CogWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pre_reqs.html">Course Pre-Requisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supplemental_math.html">Supplemental Math Materials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../audio.html">Audio Module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prereqs.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="physics-of-sound.html">The Basics of Sound</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/AudioSignalBasics.html">Exercises: Basics of Sound Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="recording_sound.html">Microphones: Recording Sound as an Analog Signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="digitizing_signals.html">Digitizing an Analog Signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/WorkingWithMic.html">Exercises: Working with the Microphone</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/AnalogToDigital.html">Exercises: Analog to Digital Encoding</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Decomposing Audio Signals: Fourier Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Some-Preliminary-Remarks-About-This-Material">Some Preliminary Remarks About This Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Retracing-Our-Steps">Retracing Our Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A-Cacophony-of-Data:-The-Need-for-Frequency-Decomposition">A Cacophony of Data: The Need for Frequency Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Fourier-Series">Fourier Series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#A-Simple-Example-with-a-Truncated-Fourier-Series">A Simple Example with a Truncated Fourier Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Reformulating-the-Fourier-Series-Using-Euler’s-Formula">Reformulating the Fourier Series Using Euler’s Formula</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Reading-Comprehension-Exercise-Solutions">Reading Comprehension Exercise Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Code-for-Reproducing-Figures">Code for Reproducing Figures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Plotting-the-Top-n-Fourier-Components">Plotting the Top-n Fourier Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plotting-the-Fourier-Spectrum-for-t-cubed">Plotting the Fourier Spectrum for t-cubed</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="discrete_fourier_transforms.html">The Discrete Fourier Transform (DFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/BasicsOfDFT.html">Exercises: Basics of DFTs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/DFTOfVariousSignals.html">Exercises: DFTs of Various Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/ApplicationsOfDFTs.html">Exercises: Applications of DFTs</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_spectrograms.html">Introduction to Spectrogram Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/spectrogram.html">Exercise: Creating Our Own Spectrogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio_features.html">Matching Audio Recordings</a></li>
<li class="toctree-l2"><a class="reference internal" href="Exercises/PeakFinding.html">Exercises: Finding Local Peaks in a 2-D Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="capstone_summary.html">Capstone Project: Song Recognition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vision.html">Vision Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language.html">Language Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">Cheat Sheets</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CogWorks</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../audio.html">Audio Module</a> &raquo;</li>
        
      <li>Decomposing Audio Signals: Fourier Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Audio/fourier_analysis.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Decomposing-Audio-Signals:-Fourier-Analysis">
<h1>Decomposing Audio Signals: Fourier Analysis<a class="headerlink" href="#Decomposing-Audio-Signals:-Fourier-Analysis" title="Permalink to this headline">¶</a></h1>
<p>This section will introduce us to the world of <strong>Fourier analysis</strong>, which describes how general mathematical functions can be represented in terms of sinusoids. It will enable us to describe audio signals in terms of the pure tones of different frequencies. Doing so will permit us to reenvision a temporal sequence of audio samples as a spectrum of audio frequencies that we can rank in terms of how prominent they are in the audio recording. This will serve as a critical step-forward for us in
our quest to write a computer program that can recognize different songs.</p>
<p>Our foray into Fourier (heh) will be split into two sections. The present section will introduce us to <strong>Fourier series</strong> and the notion of representing a function as an infinite sum of sinusoids. It sets the stage with some rich concepts and mathematics in preparation for the next section, which will introduce us to the <strong>discrete Fourier transform (DFT)</strong>. The section on the DFT is where the rubber hits the road and we will finally learn how to perform Fourier analysis on actual data.</p>
<div style="text-align: center">
<p>
<img src="../_images/waveform_to_spectrum_illustration.png" alt="Illustration of the Fourier transform process" width="700">
</p>
</div><div class="section" id="Some-Preliminary-Remarks-About-This-Material">
<h2>Some Preliminary Remarks About This Material<a class="headerlink" href="#Some-Preliminary-Remarks-About-This-Material" title="Permalink to this headline">¶</a></h2>
<p>It must be noted that Fourier analysis is an area of mathematics whose application extends far beyond the annals of audio analysis. While the foundations for these methods lie purely in the realm of mathematics, their validity does not depend on the nature of sound nor the physiology of hearing. In fact, the methods of Fourier frequently play a starring role in areas of theoretical physics, signal processing, and other technical fields. Hopefully the material provided here will serve as a
starting point for the many exotic and rich pieces of mathematical analysis that lie in the reader’s future.</p>
<p>We cannot afford to dive into the rigorous mathematical underpinnings of the Fourier series or the derivation of the discrete Fourier transform – to do so would simply be beyond the depths of our goals in this course. <a class="reference external" href="http://www-personal.umich.edu/~mejn/cp/">Mark Newman’s book Computational Physics</a> is a great resource that provides a more detailed derivation and treatment of discrete Fourier transforms and its variations. It also contains excellent exercises that will enrich the reader’s
understanding of this material and its applications.</p>
<p>Jez Swanson’s <a class="reference external" href="http://www.jezzamon.com/fourier/">Interactive Introduction to Fourier Transforms</a> is also a wonderful resource that can help us enrich our understanding of Fourier analysis and its applications beyond audio analysis. It is highly recommended that the reader take a moment to enjoy this fun and accessible introduction to Fourier analysis.</p>
<p>Finally, this material will be followed by several separate sections of exercises for the reader to complete. This explains why this section might be somewhat sparse on reading comprehension questions; it is strongly recommended that the reader completes these exercises to help “fully bake” the ideas presented here.</p>
</div>
<div class="section" id="Retracing-Our-Steps">
<h2>Retracing Our Steps<a class="headerlink" href="#Retracing-Our-Steps" title="Permalink to this headline">¶</a></h2>
<p>We’ve embarked on quite the journey into the land of audio processing. So far, we have distilled sound waves down to traveling fluctuations in air pressure, which vibrate one’s eardrums in the same way that they vibrate the diaphragm of a microphone. We saw that a dynamic microphone taps directly into a classical law of electricity and magnetism in order to couple these mechanical vibrations to oscillations of an electrical signal across a wire; this marks the creation of an analog electrical
signal that serves as a recording of the sound wave impinging on the microphone. A method known as pulse code modulation (PCM) provided us with a simple recipe for digitizing this analog signal so that the analog recording can be stored on and processed by a digital computer. It prescribed that we pick a sampling rate and a bit-depth with which we discretize our analog signal in time and amplitude, respectively, so that we can extract a sequence of audio samples that we encode as digital numbers
on our computers.</p>
<p>At last, we have a digital audio file in our possession, which serves as a recording of the cascades of colliding air molecules that were crashing against our microphone (of course, the fidelity of this recording is limited by the quality of the materials in our microphone, and by how stingy we were with the bit-depth and sampling rate that we allotted in the digitization process). Keeping in mind our overarching goal – creating a song-recognition app – perhaps now we can visualize some of our
digital recordings and get some ideas about how we can pick out distinguishing qualities between songs.</p>
<p>This will work, right? … Right!?</p>
</div>
<div class="section" id="A-Cacophony-of-Data:-The-Need-for-Frequency-Decomposition">
<h2>A Cacophony of Data: The Need for Frequency Decomposition<a class="headerlink" href="#A-Cacophony-of-Data:-The-Need-for-Frequency-Decomposition" title="Permalink to this headline">¶</a></h2>
<p>The following plot displays the temporal waveform for a trumpet playing a chord for roughly <span class="math notranslate nohighlight">\(2.5\;\mathrm{seconds}\)</span>.</p>
<div style="text-align: center">
<p>
<img src="../_images/trumpet_waveform.png" alt="Temporal waveform for a trumpet" width="500">
</p>
</div><p>This is… a total mess. Despite all of our hard work to understand the nature of sound waves, and to record them, we can’t seem to glean much information from our audio data at all. We can certainly identify how long the recording lasted for; that much is trivial. We are also able to see any gross changes in volume during the recording. That being said, we certainly cannot distill what <em>notes</em> are being played during the recording.</p>
<p>Fortunately, we will soon find that this data is far from useless, and that we simply need the right mathematical tools to make sense of it. As promised at the outset of this section, we will learn how to <em>transform</em> this waveform into the <strong>Fourier spectrum</strong> depicted below. If we are to think of the trumpet’s sound wave as a <a class="reference external" href="https://rsokl.github.io/CogWeb/Audio/physics-of-sound.html#Realistic-Sounds-and-the-Principle-of-Superposition">superposition</a> of <a class="reference external" href="https://rsokl.github.io/CogWeb/Audio/physics-of-sound.html#Quantifying-Sound:-Pure-Tones">pure
tones</a> of different frequencies, then this spectrum shows us the pure-tone frequencies that are the most prominent in this sound wave.</p>
<div style="text-align: center">
<p>
<img src="../_images/trumpet_spectrum.png" alt="Fourier spectrum for a trumpet" width="500">
</p>
</div><p>The Fourier spectrum is meant to be read like a histogram: the <span class="math notranslate nohighlight">\(x\)</span>-axis carries a sequence of ascending of frequency values and the height of a vertical column indicates the relative strength of that frequency-component in the audio clip being analyzed. We will soon see the precise meaning of the quantity plotted on the <span class="math notranslate nohighlight">\(y\)</span>-axis, the <strong>Fourier coefficient</strong>: <span class="math notranslate nohighlight">\(|a_{k}|\)</span>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reading Comprehension: Reading a Fourier Spectrum</strong>:</p>
<p>According to the Fourier spectrum for the trumpet depicted above, what are the frequencies of the four most prominent notes in the audio recording? Estimate these values to 2 significant figures.</p>
</div>
<p>The Fourier spectrum gives us insight into what an audio recording sounds like, because the human ear itself performs a “frequency decomposition” when sending auditory signals to the brain. Within the the inner ear, the cochlea contains a spiraling ramp of hair cells, which respond mechanically to vibrations in ear fluid. The hair cells near the beginning of this “ramp” respond to high-frequency vibrations (up to roughly <span class="math notranslate nohighlight">\(20,000\;\mathrm{Hz}\)</span>), and as one marches along the ramp the hair
cells resonate to progressively lower frequency vibrations (down to <span class="math notranslate nohighlight">\(20\;\mathrm{Hz}\)</span>). The following video provides a nice summary of this physiology.</p>
<div style="text-align: center">
</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/eQEaiZ2j9oc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>
</div></div>
<div class="section" id="Fourier-Series">
<h2>Fourier Series<a class="headerlink" href="#Fourier-Series" title="Permalink to this headline">¶</a></h2>
<p>A <strong>Fourier series</strong> is a representation of a function defined on a restricted domain by a sum over an infinite number of weighted sinusoidal functions. Given a function <span class="math notranslate nohighlight">\(f(t)\)</span> defined on a domain <span class="math notranslate nohighlight">\([0, T)\)</span> (the square bracket indicates that <span class="math notranslate nohighlight">\(0\)</span> is included in the domain, whereas the rounded bracket indicates that <span class="math notranslate nohighlight">\(T\)</span> is not included), we can represent that function on that domain using a Fourier series:</p>
<div class="math notranslate nohighlight">
\begin{equation}
f(t) = \frac{a_0}{2} + \sum_{k=1}^{\infty}{a_{k}\cos\bigg(2\pi\frac{k}{T}t - \varphi_k\bigg)};\; t \in [0, T)
\end{equation}</div><p>For instance, this means that we could take <span class="math notranslate nohighlight">\(f(t)=e^t\)</span>, with <span class="math notranslate nohighlight">\(t \in [0, 10)\)</span>, and represent in terms of sinusoids via a Fourier series; to do so, we need to find appropriate values for <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> and <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\infty}\)</span>, particular to <span class="math notranslate nohighlight">\(e^t\)</span> with <span class="math notranslate nohighlight">\(t \in [0, 10)\)</span>.</p>
<p>See that <strong>the</strong> <span class="math notranslate nohighlight">\(k^\textbf{th}\)</span> <strong>term in this series is a cosine function that oscillates with a frequency</strong> <span class="math notranslate nohighlight">\(\nu_k = \frac{k}{T}\)</span>, and thus each term in the series oscillates with an increasing frequency as one progresses “deeper” into the series. The above equation says that, by adding an infinite number of cosine functions with frequencies of <span class="math notranslate nohighlight">\(\frac{1}{T}, \frac{2}{T}, \dots\)</span>, using some combination of respective phases (<span class="math notranslate nohighlight">\(\varphi_k\)</span>) and amplitudes (<span class="math notranslate nohighlight">\(a_k\)</span>), we
can <em>exactly</em> represent <span class="math notranslate nohighlight">\(f(t)\)</span> on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span>. Note that the term <span class="math notranslate nohighlight">\(\frac{a_0}{2}\)</span> can be thought of as a cosine wave with a frequency <span class="math notranslate nohighlight">\(\frac{0}{T}\)</span>, which is just a constant value. For our purposes, we will assume that <span class="math notranslate nohighlight">\(t\)</span>, and every amplitude (<span class="math notranslate nohighlight">\(a_k\)</span>) and phase (<span class="math notranslate nohighlight">\(\varphi_k\)</span>), are real-valued numbers (i.e. all <span class="math notranslate nohighlight">\(t, (a_k)_{k=0}^{\infty}, (\varphi_k)_{k=1}^{\infty}, f(t) \in \mathbb{R}\)</span>).</p>
<p>Thus, in order to represent a function using a Fourier series, <em>one must find the appropriate values for</em> <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> <em>and</em> <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\infty}\)</span> <em>for that function</em>. Once we compute these values, plotting <span class="math notranslate nohighlight">\(|a_k|\)</span> vs <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> would reveal the <strong>Fourier spectrum</strong> for this function. <span class="math notranslate nohighlight">\(|a_k|\)</span> is often referred to as a <strong>Fourier coefficient</strong>, and, as already established, <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> is the frequency (<span class="math notranslate nohighlight">\(\nu_k\)</span>) associated with that
coefficient.</p>
<p>Tying this introduction to Fourier series back to our discussion of audio analysis, we can think of <span class="math notranslate nohighlight">\(f(t)\)</span> as any analog audio signal that was recorded by a microphone for the span of time <span class="math notranslate nohighlight">\(T\)</span>. It follows that if we were to find the appropriate values of <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> and <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\infty}\)</span> to represent this analog signal using a Fourier series, then we would have successfully represented our analog signal as a superposition of an infinite number of
pure tones, where the <span class="math notranslate nohighlight">\(k^\text{th}\)</span> pure tone has a frequency of <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> and an amplitude of <span class="math notranslate nohighlight">\(a_k\)</span>. The relative sizes of <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> tell us how prominently “featured” each pure tone is in the constitution of that analog audio signal; we can summarize this information by plotting its Fourier spectrum: <span class="math notranslate nohighlight">\(|a_k|\)</span> vs <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title fa fa-exclamation-circle"><strong>Looking Ahead:</strong></p>
<p>We will not be learning how to solve for <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> and <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\infty}\)</span> for an infinite Fourier series – doing so would require too much mathematical sophistication, and it would not help us analyze actual audio data. Instead, we will be tackling a restricted version of this problem.</p>
<p>Rather than representing a continuous function <span class="math notranslate nohighlight">\(f(t)\)</span> using an infinite sum of sinusoids (i.e. a Fourier series), we will learn to represent a <em>finite</em> sequence of values, <span class="math notranslate nohighlight">\(f(t_0), \dots, f(t_{N-1})\)</span>, using a <em>finite</em> sum of sinusoids whose parameters’s values, <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\left\lfloor\frac{N}{2}\right\rfloor}\)</span> and <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\left\lfloor\frac{N}{2}\right\rfloor}\)</span>, we must find. The <strong>discrete Fourier transform</strong>, which is introduced in the next section of the
course, will enable us to compute these values so that we can transform our audio samples into a spectrum of frequency components.</p>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reading Comprehension: It’s Just a Phase</strong></p>
<p>In the function signature <span class="math notranslate nohighlight">\(\cos(t - \varphi)\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span> is known as the “phase shift”. If you are not familiar with the concept of phase shifts, see that <span class="math notranslate nohighlight">\(\varphi\)</span> can effectively “shift” the cosine’s waveform along the <span class="math notranslate nohighlight">\(t\)</span> axis; try plotting <span class="math notranslate nohighlight">\(\cos(t - \varphi)\)</span> for various values of <span class="math notranslate nohighlight">\(\varphi\)</span> to see its effect. Start off with multiples of <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>; then try other values.</p>
<p>In which direction, towards <span class="math notranslate nohighlight">\(-t\)</span> or <span class="math notranslate nohighlight">\(+t\)</span>, does the waveform move when you increase <span class="math notranslate nohighlight">\(\varphi\)</span>? What is the smallest value of <span class="math notranslate nohighlight">\(\varphi\)</span> for which <span class="math notranslate nohighlight">\(\cos(t - \varphi) = \sin(t)\)</span>?</p>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reading Comprehension: “Fourier, Fourier, Fourier”, You Sound Like a Broken Record</strong></p>
<p>A function <span class="math notranslate nohighlight">\(g(t)\)</span> that is periodic with a period of <span class="math notranslate nohighlight">\(T\)</span> satisfies the relationship <span class="math notranslate nohighlight">\(g(t+T) = g(t)\)</span> for any <span class="math notranslate nohighlight">\(t\)</span>. Show that the Fourier series representation of any function on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span> is periodic with a period of <span class="math notranslate nohighlight">\(T\)</span>.</p>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reading Comprehension: Other Series Representations of Functions</strong></p>
<p>The notion of representing functions in terms of sums of other functions can be surprising at first blush, and Fourier series are not the only shape-shifting series out there. A Taylor series uses an infinite sum of polynomials to represent a function. This can be used to produce a “leading order” polynomial approximation for a function in calculations.</p>
<p>The Taylor series representation for <span class="math notranslate nohighlight">\(\sin(x)\)</span>, centered about <span class="math notranslate nohighlight">\(x=0\)</span> is:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\sin(x) = \sum_{n=0}^{\infty}{\frac{(-1)^n}{(2n+1)!}x^{2n+1}}
\end{equation}</div><p>Note that this infinite sum is an <em>exact</em> representation of <span class="math notranslate nohighlight">\(\sin(x)\)</span> for all <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span>.</p>
<p>Plot <span class="math notranslate nohighlight">\(\sin(x)\)</span> on <span class="math notranslate nohighlight">\(x \in [-2\pi, 2\pi]\)</span> and then plot the Taylor series representation of <span class="math notranslate nohighlight">\(\sin(x)\)</span> up to (and including) the 11th order term in the polynomial (i.e. <span class="math notranslate nohighlight">\(n=5\)</span>) and appreciate how well this truncated series approximates <span class="math notranslate nohighlight">\(\sin(x)\)</span> within <span class="math notranslate nohighlight">\(|x|&lt; \pi\)</span>. Try including higher-order terms from the Taylor series. Does this improve the approximation?</p>
<p>If you want to replace <span class="math notranslate nohighlight">\(\sin(x)\)</span> when <span class="math notranslate nohighlight">\(x\approx 0\)</span> with a simple approximation, what is the best first-order (degree-<span class="math notranslate nohighlight">\(1\)</span>) polynomial approximation that you could use?</p>
</div>
<div class="admonition warning">
<p class="admonition-title fa fa-exclamation-circle"><strong>Some Mathematical Details</strong>:</p>
<p>Fourier series can be used to represent a very broad class of functions, but we cannot represent <span class="math notranslate nohighlight">\(f(t)\)</span> with a Fourier series if <span class="math notranslate nohighlight">\(f(t)\)</span> is unbounded (goes to positive or negative infinity) on the prescribed domain, or if <span class="math notranslate nohighlight">\(f(t)\)</span> has infinitely many discontinuities within the domain. There are many <a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_series#Convergence">additional details to discuss regarding series convergence</a>, but they are not appropriate for our discussion.</p>
<p>An additional note: although we use the symbols <span class="math notranslate nohighlight">\(f(t)\)</span> and <span class="math notranslate nohighlight">\(T\)</span> to describe the Fourier series in a way that conjures up our discussion of time, temporal audio waveforms, and analog signals, it is critical to keep in mind that the underpinnings of a Fourier series are solely those of mathematics; it is not a result of physics, but rather is a tool that can be used to describe physics.</p>
</div>
<div class="section" id="A-Simple-Example-with-a-Truncated-Fourier-Series">
<h3>A Simple Example with a Truncated Fourier Series<a class="headerlink" href="#A-Simple-Example-with-a-Truncated-Fourier-Series" title="Permalink to this headline">¶</a></h3>
<p>Let’s ground this introduction to Fourier series in an example; after all, it is quite surprising to think that we can add a bunch of sinusoids together to produce non-sinusoidal functions, like, say, a polynomial. Suppose we want to represent the function <span class="math notranslate nohighlight">\(f(t) = t^3\)</span> on the domain <span class="math notranslate nohighlight">\([0, 3)\)</span> using a Fourier series. Since it can be hard to wrap one’s mind around the idea of summing an infinity of cosines together, let’s see that summing just a few sinusoids together can yield
something that roughly matches this function. Once again, note that we have not discussed <em>how</em> we find the proper values for <span class="math notranslate nohighlight">\((a_k)_{k=0}^{\infty}\)</span> and phases <span class="math notranslate nohighlight">\((\varphi_k)_{k=1}^{\infty}\)</span>; this example simply assumes that we have access to these quantities.</p>
<p>The following plot shows the contributions of the first four terms in the Fourier series for <span class="math notranslate nohighlight">\(f(t) = t^3\)</span> on <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span>, which are roughly</p>
<div class="math notranslate nohighlight">
\begin{equation}
t^3 \approx 6.7 + 8.4 \cos\bigg(2\pi\cdot\frac{1}{3}t - (-1.1)\bigg) + 4.3\cos\bigg(2\pi\cdot\frac{2}{3}t - (-1.3)\bigg) + 2.1\cos\bigg(2\pi\cdot\frac{3}{3}t - (-1.4)\bigg);\; t \in [0, 3)
\end{equation}</div><div style="text-align: center">
<p>
<img src="../_images/cubic_fourier_top3.png" alt="Top-3 Fourier components of t-cubed" width="600">
</p>
</div><p>While it is a stretch to call that wobbly blue noodle an “approximation” of <span class="math notranslate nohighlight">\(t^3\)</span>, the combination of these four terms does roughly follow the trend of this curve within the interval <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span>. The <span class="math notranslate nohighlight">\(k=1\)</span> term, which oscillates with a frequency of <span class="math notranslate nohighlight">\(1/3\)</span>, is the most prominent contributor to this four-term sum: its amplitude is double that of the <span class="math notranslate nohighlight">\(k=2\)</span> term, which oscillates with a frequency of <span class="math notranslate nohighlight">\(2/3\)</span>, and is nearly quadruple that of the <span class="math notranslate nohighlight">\(k=3\)</span> term.</p>
<p>Adding more terms from the series will improve this approximation. Indeed, if we include <span class="math notranslate nohighlight">\(500\)</span> terms from the Fourier series, it fits <span class="math notranslate nohighlight">\(f(t) = t^3\)</span> on <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span> very closely!</p>
<div style="text-align: center">
<p>
<img src="../_images/cubic_fourier_top500.png" alt="Top-500 Fourier components of t-cubed" width="600">
</p>
</div><p>The amplitudes and phases of these sinusoids, which oscillate with the respective frequencies <span class="math notranslate nohighlight">\(\frac{0}{T}, \frac{1}{T}, \frac{2}{T}, \dots, \frac{499}{T}\)</span>, have been carefully selected so that the sinusoids smooth one another out when added together and cooperate to approximate <span class="math notranslate nohighlight">\(t^3\)</span>. Thus, we need not rely on the concept of infinity to begin to understand how Fourier series work.</p>
<p>Plotting <span class="math notranslate nohighlight">\(|a_k|\)</span> vs <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> reveals the Fourier spectrum for this function.</p>
<div style="text-align: center">
<p>
<img src="../_images/cubic_fourier_spectrum.png" alt="Fourier spectrum of t-cubed" width="600">
</p>
</div><p>Study this plot and read off the values for <span class="math notranslate nohighlight">\(|a_0|,\;|a_1|,\;|a_2|,\;|a_4|,\;\)</span> and see that they match the amplitudes from the four-term truncated Fourier series written above.</p>
</div>
<div class="section" id="Reformulating-the-Fourier-Series-Using-Euler’s-Formula">
<h3>Reformulating the Fourier Series Using Euler’s Formula<a class="headerlink" href="#Reformulating-the-Fourier-Series-Using-Euler’s-Formula" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This subsection contains a derivation that requires a substantial amount of comfort with complex numbers: do not worry if you don’t follow all of this. Feel free to just skim it.</p>
</div></blockquote>
<p>A common strategy for working with Fourier series, and one that is essential to presenting the standard formulation for the discrete Fourier transform, is to rewrite the sinusoids in terms of complex-valued exponentials via Euler’s formula</p>
<div class="math notranslate nohighlight">
\begin{equation}
e^{ix} = \cos(x) + i\sin(x)
\end{equation}</div><p>We do this because it is often much easier to deal with exponentials rather than sinusoids: the trigonometric identities that we memorize (or repeatedly look up in tables) become self-evident thanks to the simple rules of multiplication (i.e. <span class="math notranslate nohighlight">\(e^xe^y = e^{x+y}\)</span>) and exponentiation (i.e. <span class="math notranslate nohighlight">\((e^x)^a = e^{ax}\)</span>) that are obeyed by exponentials. Review the section on <a class="reference external" href="https://rsokl.github.io/CogWeb/Math_Materials/ComplexNumbers.html">Complex Numbers</a> if you need a refresher.</p>
<p>Based on Euler’s formula, see that we can rewrite cosine as <span class="math notranslate nohighlight">\(\cos{x} = \frac{1}{2}(e^{ix} + e^{-ix})\)</span>. Thus we can rewrite the terms of our Fourier series as:</p>
<div class="math notranslate nohighlight">
\begin{align}
\frac{a_0}{2} + \sum_{k=1}^{\infty}{a_{k}\cos\bigg(2\pi\frac{k}{T}t - \varphi_k\bigg)} &amp; = \frac{a_0}{2} + \sum_{k=1}^{\infty}{\frac{a_{k}}{2}\Big(e^{i\left(2\pi\frac{k}{T}t - \varphi_k\right)} + e^{-i\left(2\pi\frac{k}{T}t - \varphi_k\right)}\Big)} \\
&amp; = \frac{a_0}{2} + \sum_{k=1}^{\infty}{\frac{a_{k}}{2}\Big(e^{i\left(2\pi\frac{k}{T}t - \varphi_k\right)}\Big)} + \sum_{k=1}^{\infty}{\frac{a_{k}}{2}\Big(e^{-i\left(2\pi\frac{k}{T}t - \varphi_k\right)}\Big)} \\
&amp; = \frac{|a_0|}{2}e^{- i\varphi'_0} + \sum_{k=1}^{\infty}{\frac{|a_{k}|}{2}e^{- i\varphi'_k}e^{i 2\pi\frac{k}{T}t}} + \sum_{k=1}^{\infty}{\frac{|a_{k}|}{2}e^{i\varphi'_k}e^{i 2\pi\frac{-k}{T}t}} \\
&amp; = c_0 + \sum_{k=1}^{\infty}{c_{k}e^{i 2\pi\frac{k}{T}t}} + \sum_{k=1}^{\infty}{c^{*}_{k}e^{i 2\pi\frac{-k}{T}t}} \\
&amp; = c_0 + \sum_{k=1}^{\infty}{c_{k}e^{i 2\pi\frac{k}{T}t}} + \sum_{k=-\infty}^{-1}{c_{k}e^{i 2\pi\frac{k}{T}t}} \\
&amp; = \sum_{k=-\infty}^{\infty}{c_{k}e^{i 2\pi\frac{k}{T}t}}
\end{align}</div><p>where we have defined the <strong>complex-valued Fourier coefficients</strong></p>
<div class="math notranslate nohighlight">
\begin{equation}
c_k \triangleq \left\{
\begin{array}{lll}
\tfrac{|a_k|}{2} e^{-i \varphi'_k}, \quad &amp; k \geq 0\\
c_{|k|}^{*}, \quad &amp; k &lt; 0
\end{array}\right.
\end{equation}</div><p>Note the relationship <span class="math notranslate nohighlight">\(c_k = c_{-k}^*\)</span> for <span class="math notranslate nohighlight">\(k \neq 0\)</span>, where <span class="math notranslate nohighlight">\({}^*\)</span> denotes complex conjugation. Thus if <span class="math notranslate nohighlight">\(c_{k_o}\)</span> is some number <span class="math notranslate nohighlight">\(a + bi\)</span>, then <span class="math notranslate nohighlight">\(c_{-k_o} = c^*_{k_o} = a - bi\)</span>. We also introduce <span class="math notranslate nohighlight">\(\varphi'_k\)</span> to “absorb” the sign of <span class="math notranslate nohighlight">\(a_k\)</span> into <span class="math notranslate nohighlight">\(\varphi_k\)</span>, so that we need only work with <span class="math notranslate nohighlight">\(|a_k|\)</span>. In other words, since <span class="math notranslate nohighlight">\(e^{i0}=1\)</span> and <span class="math notranslate nohighlight">\(e^{i\pi}=-1\)</span>, we have that <span class="math notranslate nohighlight">\(\varphi_k'=\varphi_k\)</span> if <span class="math notranslate nohighlight">\(a_k\)</span> is positive, while
<span class="math notranslate nohighlight">\(\varphi_k'=\varphi_k+\pi\)</span> if <span class="math notranslate nohighlight">\(a_k\)</span> is negative.</p>
<p>Thus we can rewrite our Fourier series, <span class="math notranslate nohighlight">\(f(t)\)</span> on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span> as an infinite sum of weighted complex-valued exponentials:</p>
<div class="math notranslate nohighlight">
\begin{equation}
f(t) = \sum_{k=-\infty}^{\infty}{c_{k}e^{i 2\pi\frac{k}{T}t}};\; t \in [0, T)
\end{equation}</div><p>Given our above definition for <span class="math notranslate nohighlight">\(c_k\)</span>, see that this form of the Fourier series is <em>equivalent to the series involving real-valued sinusoids</em>. That is, despite the fact that we are now dealing with complex values, this sum will always resolve to produce a purely real-valued <span class="math notranslate nohighlight">\(f(t)\)</span>.</p>
<p>We can easily recover the familiar sinusoidal terms from these complex-valued coefficients. Given the complex-valued number <span class="math notranslate nohighlight">\(c_k = a + bi\)</span>, we can recover the amplitude and phase of the sinusoid that oscillates with frequency <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span>:</p>
<div class="math notranslate nohighlight">
\begin{equation}
|a_k| = 2|c_k| = 2\sqrt{a^2 + b^2}\\
\varphi'_k = \arctan_2(-b,a)
\end{equation}</div><p>and with these in hand, we have</p>
<div class="math notranslate nohighlight">
\begin{equation}
|a_k|\cos{\bigg(2\pi\frac{k}{T}t - \varphi'_k\bigg)} = a_k\cos{\bigg(2\pi\frac{k}{T}t - \varphi_k\bigg)}
\end{equation}</div><div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reading Comprehension: Don’t Let the Real World Pass You By</strong></p>
<p>Consider the first three coefficients for the complex-valued Fourier series of <span class="math notranslate nohighlight">\(t^3\)</span>, for <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span>:</p>
<div class="math notranslate nohighlight">
\begin{align}
\frac{a_0}{2} &amp; = 6.7\\
c_1 &amp; = 2.04 + i\: 3.64\\
c_2 &amp; = 0.50 + i\: 2.07\\
\end{align}</div><p>In Python, plot each of the corresponding real-valued sinusoids and their sum, along with <span class="math notranslate nohighlight">\(t^3\)</span>, for <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span></p>
</div>
</div>
</div>
<div class="section" id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Fourier series</strong> enables us to represent a function <span class="math notranslate nohighlight">\(f(t)\)</span> as an infinite sum of weighted sinusoids. The series can be written in terms of real-valued sinusoids, but it is also convenient to write it in terms of complex-valued exponentials (by leveraging Euler’s formula: <span class="math notranslate nohighlight">\(e^{ix} = \cos(x) + i\sin(x)\)</span>)</p>
<div class="math notranslate nohighlight">
\begin{equation}
f(t) = \frac{a_0}{2} + \sum_{k=1}^{\infty}{a_{k}\cos\bigg(2\pi\frac{k}{T}t - \varphi_k\bigg)} = \sum_{k=-\infty}^{\infty}{c_{k}e^{i 2\pi\frac{k}{T}t}};\; t \in [0, T)
\end{equation}</div><p>Here <span class="math notranslate nohighlight">\(e^{i 2\pi\frac{k}{T}t}\)</span> is a complex-valued sinusoid that oscillates with a frequency <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span>, and <span class="math notranslate nohighlight">\(c_k\)</span> is its associated complex-valued coefficient. Both <span class="math notranslate nohighlight">\(|c_k|\)</span> and <span class="math notranslate nohighlight">\(|a_k|\)</span> are referred to as <strong>Fourier coefficients</strong> (they are intimately coupled by the relation <span class="math notranslate nohighlight">\(|a_k| = 2|c_k|\)</span> for <span class="math notranslate nohighlight">\(k \geq 0\)</span>). Assuming that <span class="math notranslate nohighlight">\(f(t)\)</span> is a real-valued function, the sum of all of these complex-valued terms <em>will produce a real-valued output</em>; i.e. all of
the imaginary parts in the sum will cancel one another out.</p>
<p>If you have the number <span class="math notranslate nohighlight">\(c_k = a + bi\)</span> in hand, then the amplitude and phase-shift for the real-valued sinusoid that oscillates with frequency <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> can be recovered with ease using the relationships</p>
<div class="math notranslate nohighlight">
\begin{equation}
|a_k| = 2|c_k| = 2\sqrt{a^2 + b^2}\\
\varphi'_k = \arctan_2(-b,a)
\end{equation}</div><p>for <span class="math notranslate nohighlight">\(0 \leq k\)</span>. Having computed the sinusoid’s amplitude and phase, the real-valued sinusoid is recovered:</p>
<div class="math notranslate nohighlight">
\begin{equation}
|a_k|\cos{\bigg(2\pi\frac{k}{T}t - \varphi'_k\bigg)} = a_k\cos{\bigg(2\pi\frac{k}{T}t - \varphi_k\bigg)}
\end{equation}</div><p>The value of <span class="math notranslate nohighlight">\(|a_k|\)</span> (which is proportional to <span class="math notranslate nohighlight">\(|c_k|\)</span>) provides us with a measure of how “prominent” the sinusoid of frequency <span class="math notranslate nohighlight">\(\nu_k = \frac{k}{T}\)</span> is in the representation of <span class="math notranslate nohighlight">\(f(t)\)</span> on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span>. In terms of audio analysis, this permits us to decompose an audio signal in terms of important pure tones. Plotting <span class="math notranslate nohighlight">\(|a_k|\)</span> versus <span class="math notranslate nohighlight">\(\frac{k}{T}\)</span> displays the so-called <strong>Fourier spectrum</strong> for <span class="math notranslate nohighlight">\(f(t)\)</span>.</p>
<p>Note that we have not actually learned how to compute <span class="math notranslate nohighlight">\((c_k)_{k=-\infty}^{\infty}\)</span> in this section. We will learn how to do this for a restricted version of this problem, via the discrete Fourier transform.</p>
</div>
<div class="section" id="Reading-Comprehension-Exercise-Solutions">
<h2>Reading Comprehension Exercise Solutions<a class="headerlink" href="#Reading-Comprehension-Exercise-Solutions" title="Permalink to this headline">¶</a></h2>
<p><strong>Reading a Fourier Spectrum: Solution</strong></p>
<p>According to the Fourier spectrum for the trumpet, depicted above, what are the frequencies of the four most prominent notes in the audio recording? Estimate these values to 2 significant figures.</p>
<blockquote>
<div><p>The four tallest peaks in the Fourier spectrum correspond to the four “most prominent” notes. These reside at (approximately) <span class="math notranslate nohighlight">\(510\;\mathrm{Hz}\)</span>, <span class="math notranslate nohighlight">\(1000\;\mathrm{Hz}\)</span>, <span class="math notranslate nohighlight">\(1500\;\mathrm{Hz}\)</span>, and <span class="math notranslate nohighlight">\(2100\;\mathrm{Hz}\)</span></p>
</div></blockquote>
<p><strong>It’s Just a Phase: Solution</strong></p>
<p>In the function signature <span class="math notranslate nohighlight">\(\cos(t - \varphi)\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span> is known as the “phase shift”. If you are not familiar with the concept of phase shifts, see that <span class="math notranslate nohighlight">\(\varphi\)</span> can effectively “shift” the cosine’s waveform along the <span class="math notranslate nohighlight">\(t\)</span> axis; try plotting <span class="math notranslate nohighlight">\(\cos(t - \varphi)\)</span> for various values of <span class="math notranslate nohighlight">\(\varphi\)</span> to see its effect.</p>
<p>In which direction, towards <span class="math notranslate nohighlight">\(-t\)</span> or <span class="math notranslate nohighlight">\(+t\)</span>, does the waveform move when you increase <span class="math notranslate nohighlight">\(\varphi\)</span>? What is the smallest value of <span class="math notranslate nohighlight">\(\varphi\)</span> for which <span class="math notranslate nohighlight">\(\cos(t - \varphi) = \sin(t)\)</span>?</p>
<blockquote>
<div><p>Any function of the form <span class="math notranslate nohighlight">\(f(t - \varphi)\)</span> gets shifted to further to the right (towards <span class="math notranslate nohighlight">\(+t\)</span>) with increasing values of <span class="math notranslate nohighlight">\(\varphi\)</span>, as illustrated below. Since <span class="math notranslate nohighlight">\(\sin(t)\)</span> is “to the right” of <span class="math notranslate nohighlight">\(\cos(t)\)</span> by an amount <span class="math notranslate nohighlight">\(\frac{\pi}{^2}\)</span>, then <span class="math notranslate nohighlight">\(\cos(t - \frac{\pi}{^2}) = \sin(t)\)</span>.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cos(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;phase-shift by 1.5&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x219311552e8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Audio_fourier_analysis_39_1.png" src="../_images/Audio_fourier_analysis_39_1.png" />
</div>
</div>
<p><strong>Fourier, Fourier, Fourier; You Sound Like a Broken Record: Solution</strong></p>
<p>A function <span class="math notranslate nohighlight">\(g(t)\)</span> that is periodic with a period of <span class="math notranslate nohighlight">\(T\)</span> satisfies the relationship <span class="math notranslate nohighlight">\(g(t+T) = g(t)\)</span> for any <span class="math notranslate nohighlight">\(t\)</span>. Show that the Fourier series representation of any function on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span> is periodic with a period of <span class="math notranslate nohighlight">\(T\)</span></p>
<blockquote>
<div><p>Note that that <span class="math notranslate nohighlight">\(x \in \mathbb{Z}\)</span> means that <span class="math notranslate nohighlight">\(x\)</span> is any integer.</p>
</div></blockquote>
<blockquote>
<div><p>Since <span class="math notranslate nohighlight">\(\cos\big(2\pi\frac{k}{T}(t + T) - \varphi_k\big) = \cos\big(2\pi\frac{k}{T}t - \varphi_k + 2\pi k\big) = \cos\big(2\pi\frac{k}{T}t - \varphi_k\big)\)</span> for <span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span>, we see that each term in the Fourier series is periodic. Since each term satisfies the relation <span class="math notranslate nohighlight">\(f(t+T) = f(t)\)</span>, it is clear that <span class="math notranslate nohighlight">\(f(t + T) = f(t)\)</span> for any Fourier series defined on <span class="math notranslate nohighlight">\(t \in [0, T)\)</span>. Thus any function represented by a Fourier series on this domain will repeat itself
within each window <span class="math notranslate nohighlight">\(t \in [nT, (n+1)T)\)</span>, where <span class="math notranslate nohighlight">\(n \in \mathbb{Z}\)</span>.</p>
</div></blockquote>
<p><strong>Other Series Representations of Functions: Solution</strong></p>
<p>The Taylor series representation for <span class="math notranslate nohighlight">\(\sin(x)\)</span>, centered about <span class="math notranslate nohighlight">\(x=0\)</span> is:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\sin(x) = \sum_{n=0}^{\infty}{\frac{(-1)^n}{(2n+1)!}x^{2n+1}}
\end{equation}</div><p>Plot <span class="math notranslate nohighlight">\(\sin(x)\)</span> on <span class="math notranslate nohighlight">\(x \in [-2\pi, 2\pi]\)</span> and then plot the Taylor series representation of <span class="math notranslate nohighlight">\(\sin(x)\)</span> up to (and including) the 11th order term in the polynomial (i.e. <span class="math notranslate nohighlight">\(n=5\)</span>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">factorial</span>


<span class="k">def</span> <span class="nf">sine_taylor</span><span class="p">(</span><span class="n">max_n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">n</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>



<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sine_taylor</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;11th order approximation&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x21931235eb8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Audio_fourier_analysis_42_1.png" src="../_images/Audio_fourier_analysis_42_1.png" />
</div>
</div>
<p>If you want to replace <span class="math notranslate nohighlight">\(\sin(x)\)</span> when <span class="math notranslate nohighlight">\(x\approx 0\)</span> with a simple approximation, what is the best first-order (degree-<span class="math notranslate nohighlight">\(1\)</span>) polynomial approximation that you could use?</p>
<blockquote>
<div><p>According to the Taylor series approximation for <span class="math notranslate nohighlight">\(\sin(x)\)</span> around <span class="math notranslate nohighlight">\(x=0\)</span>, the <span class="math notranslate nohighlight">\(n=0\)</span> term produces a first-order approximation to <span class="math notranslate nohighlight">\(\sin(x)\)</span>: <span class="math">\begin{equation}
\frac{(-1)^0}{(2(0)+1)!}x^{2(0)+1} = x
\end{equation}</span></p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sine_taylor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1st order approximation&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x219312bc2b0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Audio_fourier_analysis_44_1.png" src="../_images/Audio_fourier_analysis_44_1.png" />
</div>
</div>
<p><strong>Don’t Let the Real World Pass You By: Solution</strong></p>
<p>Given the first three coefficients for the complex-valued Fourier series of <span class="math notranslate nohighlight">\(t^3\)</span>, for <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span>:</p>
<div class="math notranslate nohighlight">
\begin{align}
\frac{a_0}{2} &amp; = 6.7\\
c_1 &amp; = 2.04 + i\; 3.64\\
c_2 &amp; = 0.50 + i\; 2.07\\
\end{align}</div><p>In Python, plot the corresponding real-valued sinusoids and their sum along with <span class="math notranslate nohighlight">\(t^3\)</span>, for <span class="math notranslate nohighlight">\(t \in [0, 3)\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a0</span> <span class="o">=</span> <span class="mf">6.7</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.04</span> <span class="o">+</span> <span class="mf">3.64</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.50</span> <span class="o">+</span> <span class="mf">2.07</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># using the relationships between c_k and a_k, phi_k</span>
<span class="n">amps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="n">phases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">coeffs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># holds each of the first three terms of the Fourier</span>
<span class="c1"># series evaluated at `t`</span>
<span class="n">terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">a0</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">phase</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">phase</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">amps</span><span class="p">,</span> <span class="n">phases</span><span class="p">)</span>
<span class="p">]</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plot each term</span>
<span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">terms</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x2193128ac88&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Audio_fourier_analysis_46_1.png" src="../_images/Audio_fourier_analysis_46_1.png" />
</div>
</div>
</div>
<div class="section" id="Code-for-Reproducing-Figures">
<h2>Code for Reproducing Figures<a class="headerlink" href="#Code-for-Reproducing-Figures" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Plotting-the-Top-n-Fourier-Components">
<h3>Plotting the Top-n Fourier Components<a class="headerlink" href="#Plotting-the-Top-n-Fourier-Components" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">get_fourier_components</span><span class="p">(</span>
    <span class="n">func</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="n">domain_length</span><span class="p">,</span> <span class="n">sort_by_descending_magnitude</span><span class="o">=</span><span class="bp">False</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the N // 2 + 1 amplitude-phase terms of the inverse-DFT series</span>
<span class="sd">    of func(t), where funct t is evaluated on [0, T) in N evenly-spaced points.</span>
<span class="sd">    I.e each component</span>

<span class="sd">                     A[k] cos(2*pi * f[k] * t + phi[k])</span>

<span class="sd">    is returned in a 2D array for each frequency component and each time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func : Callable[[numpy.ndarray], numpy.ndarray]</span>
<span class="sd">        A vectorized function whose fourier components are being evaluated</span>

<span class="sd">    num_samples : int</span>
<span class="sd">        The number of samples used, N</span>

<span class="sd">    domain_length : float</span>
<span class="sd">        The upper bound, T, on the sampling domain: [0, T)</span>

<span class="sd">    sort_by_descending_magnitude : bool, default=False</span>
<span class="sd">        If True, the components are returned in order of decreasing amplitude</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray, shape-(N // 2 + 1, N)</span>
<span class="sd">        Axis-0 carries the respective fourier components. I.e. element-k returns</span>
<span class="sd">        the shape-(N,) array vectorized over times:</span>
<span class="sd">                       A[k] cos(2*pi * f[k] * t + phi[k])   (where t is shape-(N,))</span>
<span class="sd">        Thus calling `out.sum(axis=0)` on the output returns `func(t)`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">num_samples</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">domain_length</span>

    <span class="c1"># evaluate on [0, N)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>

    <span class="n">ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c1"># shape-(N,)</span>

    <span class="n">amps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ck</span><span class="p">)</span>
    <span class="n">phases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">ck</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">ck</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span>

    <span class="c1"># shape-(N, N //2 + 1) - time vs freq</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">amps</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freqs</span><span class="p">)</span> <span class="o">*</span> <span class="n">times</span> <span class="o">-</span> <span class="n">phases</span><span class="p">)</span>
    <span class="n">out</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">N</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># need to double count for k, N-k folding</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># transpose: freq vs time</span>

    <span class="k">if</span> <span class="n">sort_by_descending_magnitude</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">amps</span><span class="p">),</span> <span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">out</span>


<span class="k">def</span> <span class="nf">plot_topk</span><span class="p">(</span>
    <span class="n">fourier_components</span><span class="p">,</span> <span class="n">topk</span><span class="p">,</span> <span class="n">function_label</span><span class="o">=</span><span class="s2">&quot;true function&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the top-k components of a Fourier series</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fourier_components : numpy.ndarray, shape-(N // 2 + 1, N)</span>
<span class="sd">        Each of the  N//2 + 1 Fourier components, vectorized over N samples</span>

<span class="sd">    topk : int</span>
<span class="sd">        The number of Fourier compoenents to plot</span>

<span class="sd">    function_label : str</span>

<span class="sd">    ax : Optional[Axis]</span>
<span class="sd">        A matplotlib figure-axis to draw on</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tuple[Figure, Axis]</span>
<span class="sd">        The matplotlib figure and axis objects created by the plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cumout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">topk</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="n">fourier_components</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fourier component&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">cumout</span><span class="p">[</span><span class="n">topk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Sum of top-{topk} components&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">function_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$t$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">3</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">get_fourier_components</span><span class="p">(</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">domain_length</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">sort_by_descending_magnitude</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_topk</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">function_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$t^3$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Plotting-the-Fourier-Spectrum-for-t-cubed">
<h3>Plotting the Fourier Spectrum for t-cubed<a class="headerlink" href="#Plotting-the-Fourier-Spectrum-for-t-cubed" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topk</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">N</span>

<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">times</span> <span class="o">**</span> <span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">N</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))</span> <span class="o">/</span> <span class="n">T</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
    <span class="n">freqs</span><span class="p">[:</span><span class="n">topk</span><span class="p">],</span>
    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[:</span><span class="n">topk</span><span class="p">]),</span>
    <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">markerfmt</span><span class="o">=</span><span class="s2">&quot;ro&quot;</span><span class="p">,</span>
    <span class="n">basefmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span>
    <span class="n">use_line_collection</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$|a_k|$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$v_k = \frac{k}{T}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Fourier Spectrum for $t^3;\; t \in [0, 3)$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="discrete_fourier_transforms.html" class="btn btn-neutral float-right" title="The Discrete Fourier Transform (DFT)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Exercises/AnalogToDigital.html" class="btn btn-neutral float-left" title="Exercises: Analog to Digital Encoding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ryan Soklaski

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>